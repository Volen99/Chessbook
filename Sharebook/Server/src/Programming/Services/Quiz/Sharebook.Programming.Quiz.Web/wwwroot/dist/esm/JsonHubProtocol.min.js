/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/@microsoft/signalr@3.1.3/dist/esm/JsonHubProtocol.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{MessageType}from"./IHubProtocol";import{LogLevel}from"./ILogger";import{TransferFormat}from"./ITransport";import{NullLogger}from"./Loggers";import{TextMessageFormat}from"./TextMessageFormat";var JSON_HUB_PROTOCOL_NAME="json",JsonHubProtocol=function(){function e(){this.name=JSON_HUB_PROTOCOL_NAME,this.version=1,this.transferFormat=TransferFormat.Text}return e.prototype.parseMessages=function(e,o){if("string"!=typeof e)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!e)return[];null===o&&(o=NullLogger.instance);for(var t=[],r=0,s=TextMessageFormat.parse(e);r<s.length;r++){var a=s[r],n=JSON.parse(a);if("number"!=typeof n.type)throw new Error("Invalid payload.");switch(n.type){case MessageType.Invocation:this.isInvocationMessage(n);break;case MessageType.StreamItem:this.isStreamItemMessage(n);break;case MessageType.Completion:this.isCompletionMessage(n);break;case MessageType.Ping:case MessageType.Close:break;default:o.log(LogLevel.Information,"Unknown message type '"+n.type+"' ignored.");continue}t.push(n)}return t},e.prototype.writeMessage=function(e){return TextMessageFormat.write(JSON.stringify(e))},e.prototype.isInvocationMessage=function(e){this.assertNotEmptyString(e.target,"Invalid payload for Invocation message."),void 0!==e.invocationId&&this.assertNotEmptyString(e.invocationId,"Invalid payload for Invocation message.")},e.prototype.isStreamItemMessage=function(e){if(this.assertNotEmptyString(e.invocationId,"Invalid payload for StreamItem message."),void 0===e.item)throw new Error("Invalid payload for StreamItem message.")},e.prototype.isCompletionMessage=function(e){if(e.result&&e.error)throw new Error("Invalid payload for Completion message.");!e.result&&e.error&&this.assertNotEmptyString(e.error,"Invalid payload for Completion message."),this.assertNotEmptyString(e.invocationId,"Invalid payload for Completion message.")},e.prototype.assertNotEmptyString=function(e,o){if("string"!=typeof e||""===e)throw new Error(o)},e}();export{JsonHubProtocol};
//# sourceMappingURL=/sm/fe7f528b787594677e33ff29a9bb60c77412910533db82c5b25b930343bb34a8.map